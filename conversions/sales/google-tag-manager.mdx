---
title: "Google Tag Manager"
"og:title": "How to track sales conversion events with Google Tag Manager and Dub"
description: "Learn how to track sales conversion events with Google Tag Manager and Dub"
og:image: https://assets.dub.co/cms/gtm-integration.jpeg
---

import ConversionTrackingPrerequisites from "/snippets/conversion-tracking-prerequisites.mdx";
import SalesAttributes from "/snippets/sale-attributes.mdx";
import ViewConversions from "/snippets/view-conversions.mdx";

<Note>
  Conversion tracking requires a [Business plan](https://dub.co/pricing)
  subscription or higher.
</Note>

When it comes to [conversion tracking](/conversions/quickstart), a `sale` event happens when a user purchases your product or service. Examples include:

- Subscribing to a paid plan
- Usage expansion (upgrading from one plan to another)

In this guide, we will be focusing on tracking sales events for a SaaS application that uses Google Tag Manager to track conversions.

<ConversionTrackingPrerequisites />

## Configure Google Tag Manager server-side tracking

<Tip>
  If you've already set up the [Dub GTM Server Client and Tag for lead
  tracking](/conversions/leads/google-tag-manager), you can skip ahead to step
  5.
</Tip>

To track sales conversion events with Google Tag Manager, you'll need to set up a server container and configure a custom client to handle Dub conversion events.

### 1. Set up GTM Server Container

<Tip>
  If you've already set up the [Dub GTM Server Client and Tag for lead
  tracking](/conversions/leads/google-tag-manager), you can skip this step.
</Tip>

In Google Tag Manager, you'll need to use an existing server container or [create a new one](https://youtu.be/waqBSk3vkko). Server containers are the foundation for server-side tracking and allow you to process events before they reach their final destinations.

- If you already have a server container set up, you can use that
- If not, [create a new server container in your GTM workspace](https://developers.google.com/tag-platform/learn/sst-fundamentals/4-sst-setup-container)

### 2. Import Dub GTM Server Client Template

<Tip>
  If you've already set up the [Dub GTM Server Client and Tag for lead
  tracking](/conversions/leads/google-tag-manager), you can skip this step.
</Tip>

Inside your GTM server container, navigate to the **Templates** tab. Under **Client Templates**, click the **New** button.

<Frame>
  <img
    src="/images/conversions/google-tag-manager/gtm-new-client-template.png"
    alt="GTM New Client Template"
    width="1440"
    height="1024"
  />
</Frame>

This will open up the **Template Editor**. In the top right corner, click on the **⋮** button and select **Import**.

<Frame>
  <img
    src="/images/conversions/google-tag-manager/gtm-import-client-template.png"
    alt="GTM Import Client Template"
    width="1440"
    height="1024"
  />
</Frame>

Download the [gtm-server-client-template/template.tpl](https://github.com/dubinc/gtm-server-client-template/blob/main/template.tpl) file and upload it to the Template Editor. You'll see a preview of the template:

<Frame>
  <img
    src="/images/conversions/google-tag-manager/gtm-server-client-template.png"
    alt="GTM Server Client Template"
    width="1440"
    height="1024"
  />
</Frame>

Click the **Save** button in the top right to save the template.

### 3. Create Dub Server Client

<Tip>
  If you've already set up the [Dub GTM Server Client and Tag for lead
  tracking](/conversions/leads/google-tag-manager), you can skip this step.
</Tip>

Next, you'd want to create a new GTM Server Client using the imported template.

In your GTM server container, navigate to the **Clients** tab and click **New**.

<Frame>
  <img
    src="/images/conversions/google-tag-manager/gtm-new-server-client.png"
    alt="GTM New Server Client"
    width="1440"
    height="1024"
  />
</Frame>

This will open up the client configuration page, where you can choose a client type to begin setup. Under **Custom**, select the **Dub GTM Server Client** template that you created in step 2.

<Frame>
  <img
    src="/images/conversions/google-tag-manager/gtm-choose-client-type.png"
    alt="GTM Choose Client Type"
    width="1440"
    height="1024"
  />
</Frame>

Make sure your client configuration is set to the following:

- Client Name: **Dub GTM Server Client**
- Priority: **0**
- Request Path: `/dub/track`
- Debug Logging: (optional)

<Frame>
  <img
    src="/images/conversions/google-tag-manager/gtm-server-client.png"
    alt="GTM Server Client"
    width="1440"
    height="1024"
  />
</Frame>

<Note>
  Clients in GTM Server are adapters that act as bridges between the software
  running on a user's device and your server container. They receive requests
  and transform them into events that can be processed by tags.
</Note>

### 4. Import Dub GTM Server Tag Template

<Tip>
  If you've already set up the [Dub GTM Server Client and Tag for lead
  tracking](/conversions/leads/google-tag-manager), you can skip this step.
</Tip>

Next, you'll want to import the Dub GTM Server Tag template to handle sales tracking.

In your GTM server container, navigate to the **Templates** tab once again. Under **Tag Templates**, click the **New** button.

<Frame>
  <img
    src="/images/conversions/google-tag-manager/gtm-new-tag-template.png"
    alt="GTM New Tag Template"
    width="1440"
    height="1024"
  />
</Frame>

This will open up the **Template Editor**. In the top right corner, click on the **⋮** button and select **Import**.

<Frame>
  <img
    src="/images/conversions/google-tag-manager/gtm-import-client-template.png"
    alt="GTM Import Client Template"
    width="1440"
    height="1024"
  />
</Frame>

Download the [gtm-server-tag-template/template.tpl](https://github.com/dubinc/gtm-server-tag-template/blob/main/template.tpl) file and upload it to the Template Editor. You'll see a preview of the template:

<Frame>
  <img
    src="/images/conversions/google-tag-manager/gtm-server-tag-template.png"
    alt="Dub GTM Server Tag Template"
    width="1440"
    height="1024"
  />
</Frame>

Click the **Save** button in the top right to save the template.

### 5. Add Sales Tracking Tag

Last but not least, you'll want to create a new GTM Server Tag using the imported template.

In your GTM server container, navigate to the **Tags** tab and click **New**.

<Frame>
  <img
    src="/images/conversions/google-tag-manager/gtm-new-tag.png"
    alt="GTM New Tag"
    width="1440"
    height="1024"
  />
</Frame>

This will open up the tag configuration page. Under **Tag Configuration**, select the **Dub Conversion Tag** server tag template that you created in step 4.

<Frame>
  <img
    src="/images/conversions/google-tag-manager/gtm-choose-tag-type.png"
    alt="GTM Choose Tag Type"
    width="1440"
    height="1024"
  />
</Frame>

Make sure your tag configuration is set to the following:

- **Dub API Key**: Your [Dub API key](https://dub.co/docs/api-reference/api-keys) (starts with `dub_`)
- **Event**: Select "Track sale" from the dropdown
- **Customer External ID**: `customerExternalId` from the event data
- **Amount**: `amount` from the event data (in cents)
- **Currency**: `currency` from the event data (e.g., "usd")
- **Event Name**: `eventName` from the event data (e.g., "Purchase")
- **Payment Processor**: `paymentProcessor` from the event data (e.g., "stripe")
- **Invoice ID**: Map to the `invoiceId` from the event data (optional)
- **Lead Event Name**: Map to the `leadEventName` from the event data (optional)
- **Metadata**: Map to the `metadata` from the event data (optional)

<Frame>
  <img
    src="/images/conversions/google-tag-manager/gtm-track-sale-tag.png"
    alt="GTM Sales Tracking Tag"
    width="1440"
    height="1024"
  />
</Frame>

Under the **Triggering** section, configure when the tag should fire:

- Click **+** to add a new trigger
- Select **Custom Event** as the trigger type
- Set the **Event Name** to match the event name from the Dub Server Client. Default is `dub_conversion`
- Add a condition to filter for sales events:
  - **Variable**: Select a variable that contains the event type
  - **Operator**: Equals
  - **Value**: "Purchase"
- Name the trigger "Dub Sales Event Trigger" and save it

<SalesAttributes />

## Testing your setup

You can test your GTM server setup by sending a curl request to your server URL with the appropriate query parameters:

<CodeGroup>

```bash cURL
curl "https://server-side-tagging-xxx-uc.a.run.app/dub/track/sale?\
dub_id=pAzVZ3jzwZXcLMDT&\
customerExternalId=user_1K0RN3SDNAC0C1WCW4BGRS3EW&\
amount=1000&\
currency=usd&\
eventName=Purchase&\
paymentProcessor=stripe&\
invoiceId=inv_123456789&\
leadEventName=Sign%20Up&\
mode=async"
```

</CodeGroup>

## Download GTM templates

To learn more about how to track sales with Google Tag Manager, check out the following templates:

<CardGroup cols={2}>
  <Card
    title="Dub GTM Server Client Template"
    icon="github"
    href="https://github.com/dubinc/gtm-server-client-template"
  >
    A GTM server-side client template for receiving lead and sale conversion
    events from web containers
  </Card>
  <Card
    title="Dub GTM Server Tag Template"
    icon="github"
    href="https://github.com/dubinc/gtm-server-tag-template"
  >
    A GTM server-side tag template for sending lead and sale conversion events
    from your GTM server container to Dub
  </Card>
</CardGroup>

## View conversion results

And that's it – you're all set! You can now sit back, relax, and watch your conversion revenue grow. We provide 3 different views to help you understand your conversions:

<ViewConversions />
